<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">

<html lang="UTF-8" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Jackson">
    <meta name="keyword" content="slick, flat, dashboard, bootstrap, admin, template, theme, responsive, fluid, retina">
    <link rel="shortcut icon" href="javascript:;" type="image/png">
    <title>听雨轩</title>
    <th:block th:include="include/headerinclude.html::headerinclude"></th:block>
</head>
<body class="sticky-header">
<section>
    <div th:replace="include/menu-section.html::menu-section"></div>
    <div class="body-content" style="min-height: 1200px;">
        <div th:replace="include/header-section.html::header-section"></div>
        <!--body wrapper start-->
        <div class="wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <section class="panel">
                        <header class="panel-heading">
                            修改用户
                        </header>
                        <div class="panel-body">
                            <form class="form-horizontal" role="form" id="editForm" >
                                <input type="hidden" id="id" name="id" th:value="${sysUser.id}">
                                <div class="form-group">
                                    <label for="username" class="col-lg-1 col-sm-1 control-label">登录名</label>
                                    <div class="col-lg-3">
                                        <input type="text" class="form-control" id="username" name="username" th:value="${sysUser.username}" placeholder="username">
                                        <p class="help-block"></p>
                                    </div>
                                    <label for="displayName" class="col-lg-1 col-sm-1 control-label">用户名</label>
                                    <div class="col-lg-3">
                                        <input type="text" class="form-control" id="displayName" name="displayName" th:value="${sysUser.displayName}" placeholder="displayName" >
                                        <p class="help-block"></p>
                                    </div>
                                    <label for="email" class="col-lg-1 col-sm-1 control-label">邮箱</label>
                                    <div class="col-lg-3">
                                        <input type="text" class="form-control" id="email" name="email" th:value="${sysUser.email}" placeholder="email" >
                                        <p class="help-block"></p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="cellphone" class="col-lg-1 col-sm-1 control-label">手机号</label>
                                    <div class="col-lg-3">
                                        <input type="text" class="form-control" id="cellphone" name="cellphone" th:value="${sysUser.cellphone}" placeholder="cellphone" >
                                        <p class="help-block"></p>
                                    </div>
                                    <label for="lastLoginTime" class="col-lg-1 col-sm-1 control-label">最后登陆时间</label>
                                    <div class="col-lg-3">
                                        <input type="text" class="form-control" id="lastLoginTime" name="lastLoginTime" th:value="${#dates.format(sysUser.lastLoginTime, 'yyyy-MM-dd mm:hh:ss')}" placeholder="lastLoginTime" >
                                        <p class="help-block"></p>
                                    </div>
                                    <label for="lastLoginIp" class="col-lg-1 col-sm-1 control-label">最后登陆ip</label>
                                    <div class="col-lg-3">
                                        <input type="text" class="form-control" id="lastLoginIp" name="lastLoginIp" th:value="${sysUser.lastLoginIp}" placeholder="lastLoginIp" >
                                        <p class="help-block"></p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="address" class="col-lg-1 col-sm-1 control-label">地址</label>
                                    <div class="col-lg-3">
                                        <input type="text" class="form-control" id="address" name="address" th:value="${sysUser.address}" placeholder="address" >
                                        <p class="help-block"></p>
                                    </div>
                                    <label for="jobnum" class="col-lg-1 col-sm-1 control-label">工号</label>
                                    <div class="col-lg-3">
                                        <input type="text" class="form-control" id="jobnum" name="jobnum" th:value="${sysUser.jobnum}" placeholder="jobnum" >
                                        <p class="help-block"></p>
                                    </div>
                                    <label  class="col-lg-1 col-sm-1 control-label">性别</label>
                                    <div class="col-lg-3">
                                        <input type="hidden" id="gender" name="gender" th:value="${sysUser.gender}">
                                        <input type="radio" name="gender" value="1"  class="iCheck-flat-green" id="sexRadio1" checked>
                                        <label class="  control-label">男</label>
                                        <input type="radio" name="gender" value="0" class="iCheck-flat-green"  id="sexRadio0">
                                        <label class="  control-label">女</label>
                                        <input type="radio" name="gender" value="2" class="iCheck-flat-green"  id="sexRadio2">
                                        <label class="  control-label">保密</label>
                                        <p class="help-block"></p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="createdBy" class="col-lg-1 col-sm-1 control-label">创建人</label>
                                    <div class="col-lg-3">
                                        <input type="text" class="form-control" id="createdBy" name="createdBy" th:value="${sysUser.createdBy}" placeholder="createdBy" >
                                        <p class="help-block"></p>
                                    </div>
                                    <label for="createdTime" class="col-lg-1 col-sm-1 control-label">创建时间</label>
                                    <div class="col-lg-3">
                                        <input type="text" class="form-control" id="createdTime" name="createdTime" th:value="${#dates.format(sysUser.createdTime, 'yyyy-MM-dd mm:hh:ss')}" placeholder="createdTime" >
                                        <p class="help-block"></p>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <div class="col-lg-offset-2 col-lg-10 text-right">
                                        <a type="button" class="btn btn-success m-b-10" id="editForms" onclick="submit()">提交</a>
                                        <button type="button" class="btn btn-success m-b-10" onclick="javascript:history.back();">返回</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </section>
                </div>
            </div>
        </div>
        <!--body wrapper end-->

        <footer>
            2017 &copy; WisdomInfo by Liam.
        </footer>
        <div th:replace="include/right-slidebar-section.html::right-slidebar-section"></div>
        <div th:replace="include/modal-section.html::modal-section"></div>
    </div>
</section>

<footer th:replace="include/footerjs.html::footerjs"></footer>
</body>
<script>
    /*性别选择器初始化*/
    var checkNumber=$("#gender").val();
    console.log(checkNumber);

    if(checkNumber == 1){
        $("#sexRadio1").prop("checked",true);
        $("#sexRadio0").prop("checked",false);
        $("#sexRadio2").prop("checked",false);
    }
    if(checkNumber == 0){
        $("#sexRadio1").prop("checked",false);
        $("#sexRadio0").prop("checked",true);
        $("#sexRadio2").prop("checked",false);
    }
    if(checkNumber == 2){
        $("#sexRadio1").prop("checked",false);
        $("#sexRadio2").prop("checked",true);
        $("#sexRadio0").prop("checked",false);
    }
</script>
<script>
   function submit(){
       var  numberId =  Number($("#id").val());
       var lastLoginTime1 = (new Date($("#lastLoginTime").val())).getTime();
       var lastLoginTime2 = new Date(lastLoginTime1);

       var createdTime1 = (new Date($("#createdTime").val())).getTime();
       var createdTime2 = new Date(createdTime1);

        var record={
            id:numberId,
            username:$("#username").val(),
            email:$("#email").val(),
            cellphone:$("#cellphone").val(),
            lastLoginTime:lastLoginTime2,
            lastLoginIp:$("#lastLoginIp").val(),
            address:$("#address").val(),
            jobnum:$("#jobnum").val(),
            gender:$("input[name='gender']:checked").val(),
            createdBy:$("#createdBy").val(),
            createdTime:createdTime2
        };
        var formData = new FormData($('#editForm')[0]);
        $.ajax({
            "url": "edit",
            "type": "post",
            "data": JSON.stringify(record),
            "contentType": "application/json",
            "dataType": "json"
        }).done(function (data) {
            if (data.success){
                alert("修改成功，点击确定继续")
                window.location.href="list";
            } else {
              alert("修改失败");
            }
        }).fail(function () {
            alert("修改失败");
        });
    }
   Date.prototype.format = function(fmt) {
       var o = {
           "M+" : this.getMonth()+1,                 //月份
           "d+" : this.getDate(),                    //日
           "h+" : this.getHours(),                   //小时
           "m+" : this.getMinutes(),                 //分
           "s+" : this.getSeconds(),                 //秒
           "q+" : Math.floor((this.getMonth()+3)/3), //季度
           "S"  : this.getMilliseconds()             //毫秒
       };
       if(/(y+)/.test(fmt)) {
           fmt=fmt.replace(RegExp.$1, (this.getFullYear()+"").substr(4 - RegExp.$1.length));
       }
       for(var k in o) {
           if(new RegExp("("+ k +")").test(fmt)){
               fmt = fmt.replace(RegExp.$1, (RegExp.$1.length==1) ? (o[k]) : (("00"+ o[k]).substr((""+ o[k]).length)));
           }
       }
       return fmt;
   }
</script>
</html>